# Critical Vulnerability Analysis – Week 2

## Scan Context
- **Project:** VulnVision 360 – Continuous Compliance & Threat Exposure Engine
- **Week:** Week 2 (Vulnerability Assessment)
- **Scan Type:** Authenticated Scan (Internal View)
- **Target Host:** 192.168.186.129 (Metasploitable)
- **Scanner:** OpenVAS Default (GVM)
- **Scan Config:** Full and Fast
- **Max Severity Observed:** 10.0 (Critical)


## Critical Findings Identified (CVSS 9.0+)

| Vulnerability Name | CVSS | Confidence |
|-------------------|------|------------|
| The rexec service is running | 10.0 | 80% |
| rlogin Passwordless Login | 10.0 | 80% |
| Distributed Ruby (dRuby/DRb) Multiple RCE Vulnerabilities | 10.0 | 99% |
| TWiki < 4.2.4 Multiple XSS / Command Execution Vulnerabilities | 10.0 | 80% |
| Possible Backdoor: Ingreslock | 10.0 | 99% |
| Operating System (OS) End of Life (EOL) Detection | 10.0 | 80% |
| PHP < 5.3.13, 5.4.x < 5.4.3 Multiple Vulnerabilities (Active Check) | 9.8 | 95% |
| Apache Tomcat AJP RCE Vulnerability (Ghostcat) (Active Check) | 9.8 | 99% |

# Selected Critical Vulnerability for Deep Analysis
## 1) Apache Tomcat AJP RCE Vulnerability (Ghostcat)

### Overview
The scan detected that the target host is vulnerable to **Apache Tomcat AJP Remote Code Execution**, commonly known as **Ghostcat**.  
This vulnerability can allow attackers to read sensitive files and potentially achieve **remote code execution** depending on server configuration.

### Severity
- **CVSS Score:** 9.8 (Critical)
- **Confidence:** 99%

### Security Impact
If exploited successfully, an attacker may:
- Read sensitive files such as configuration files and credentials
- Access internal web application source code
- Potentially execute remote commands depending on Tomcat deployment
- Gain unauthorized access to the underlying system

### Attack Surface
This vulnerability is exploitable through the **AJP (Apache JServ Protocol)** interface, typically running on port **8009**.

### Exploit Availability
Ghostcat is widely documented and has public Proof-of-Concept (PoC) exploits available online.  
Attackers can leverage this vulnerability to exfiltrate sensitive resources or escalate further into the environment.

### Recommended Remediation
- Disable AJP connector if not required
- Restrict AJP port access (allow only localhost or trusted reverse proxies)
- Upgrade Apache Tomcat to a patched version
- Apply firewall restrictions to block external access to port 8009
- Perform a post-remediation scan to confirm closure

# Additional High-Risk Critical Issues (Supporting Evidence)

## 2) Distributed Ruby (dRuby/DRb) Multiple RCE Vulnerabilities
- **CVSS:** 10.0 (Critical)
- **Confidence:** 99%
- **Impact:** Potential remote code execution and complete host compromise.
- **Fix:** Disable DRb if unused, update Ruby packages, restrict service exposure.

## 3) rlogin Passwordless Login
- **CVSS:** 10.0 (Critical)
- **Confidence:** 80%
- **Impact:** Allows unauthorized authentication access without proper password enforcement.
- **Fix:** Disable rlogin service, enforce SSH-only access, remove legacy remote login tools.


## 4) rexec Service Running
- **CVSS:** 10.0 (Critical)
- **Confidence:** 80%
- **Impact:** rexec is insecure legacy remote execution service that can allow attacker compromise.
- **Fix:** Disable rexec, block associated ports, replace with secure alternatives (SSH).

# Conclusion (Week 2 Gate Check)
The authenticated vulnerability scan successfully identified multiple **Critical CVEs (CVSS 9.8–10.0)** on the Metasploitable host.  
This confirms that internal credentialed scanning provides deeper vulnerability visibility compared to unauthenticated scans.

**Week 2 Outcome:**
- Critical vulnerabilities identified: **Multiple**
- Exploit feasibility: **High**
- Remediation priority: **Immediate**
- Next Step: Automate remediation in Week 4 and validate with re-scan.
